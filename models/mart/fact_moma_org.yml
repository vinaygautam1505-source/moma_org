version: 2

models:
  - name: fact_moma
    description: "Fact table for MOMA artworks with cleaned numeric measures and date references."
    columns:
      - name: OBJECT_ID
        description: "Unique identifier for each artwork"
        
      - name: BEGIN_DATE
        description: "Starting year of the artwork (absolute value)"
        tests:
          - not_null
          - accepted_range:
              min: 0
              max: 3000  # realistic year range

      - name: END_DATE
        description: "Ending year of the artwork (absolute value)"
        tests:
          - accepted_range:
              min: 0
              max: 3000

      - name: DATE_COL
        description: "Generic date column if applicable"
        tests:
          - dbt_utils.expression_is_true:
              expression: "DATE_COL >= '1900-01-01' AND DATE_COL <= '2100-12-31'"
              

      - name: DEPTH_CM
        description: "Depth in centimeters"
        tests:
          - not_null
          - accepted_range:
              min: 0
              max: 10000

      - name: WIDTH_CM
        description: "Width in centimeters"
        tests:
          - not_null
          - accepted_range:
              min: 0
              max: 10000

      - name: HEIGHT_CM
        description: "Height in centimeters"
        tests:
          - not_null
          - accepted_range:
              min: 0
              max: 10000

      - name: LENGTH_CM
        description: "Length in centimeters"
        tests:
          - accepted_range:
              min: 0
              max: 10000

      - name: WEIGHT_KG
        description: "Weight in kilograms"
        tests:
          - accepted_range:
              min: 0
              max: 10000

      - name: DATE_ACQUIRED
        description: "Date the artwork was acquired"
        tests:
          - not_null
          - dbt_utils.expression_is_true:
              expression: "DATE_ACQUIRED >= '1900-01-01' AND DATE_ACQUIRED <= '2100-12-31'"
    

      - name: CONSTITUENTED
        description: "ID of the artist or constituent"
        tests:
          - not_null
          

      - name: DURATION_SEC
        description: "Duration of the artwork in seconds (if applicable)"
        tests:
          - dbt_utils.expression_is_true:
              expression: "DURATION_SEC >= 0 AND DURATION_SEC <= 1000000"
            
         
      - name: SEAT_HEIGHT_CM
        description: "Seat height in centimeters (if applicable)"
        tests:
          - dbt_utils.expression_is_true:
              expression: "SEAT_HEIGHT_CM >= 0 AND SEAT_HEIGHT_CM <= 500"
             

      - name: DIAMETER_CM
        description: "Diameter in centimeters (if applicable)"
        tests:
          - dbt_utils.expression_is_true:
              expression: "DIAMETER_CM >= 0 AND DIAMETER_CM <= 1000"
              

      - name: ACCESSIONNUMBER
        description: "Accession number of the artwork"
        tests:
          - not_null
          
